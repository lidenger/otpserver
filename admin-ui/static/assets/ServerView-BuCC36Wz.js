import{_ as ve,r as n,o as fe,a as V,b as ge,c as G,d as be,e as a,w as t,n as Ve,u as s,i as u,F as Se,f as x,g as k,s as _e,h as J,j as r,k as ce,l as we,t as B,m as xe,E as N}from"./index-Bjt1ygZr.js";const ke={class:"card-header"},Ee={class:"dialog-footer"},Ce={class:"dialog-footer"},Ie={class:"dialog-footer"},ye={class:"dialog-footer"},De={class:"server-dialog-header"},Ue={class:"dialog-footer"},Pe={class:"dialog-footer"},Ne={__name:"ServerView",setup(He){let Q=n(!1),M=n([]),H=n(1),z=n(10),Y=n(0),D=n(""),g=n(!1),p=n({isEnable:!0,isOperateSensitiveData:!1,isEnableIPlist:!1}),W=window.innerHeight,$=n({height:""}),f=n({}),E=n(!1),b=n({}),S=n(!1),_=n({}),c=n(!1),C=n(!1),j=n([]),w=n(!1),I=n({});fe(()=>{$.value.height=W-108+"px"});const X=()=>{y()},Z=()=>{D.value="",y()},K=()=>{y()},L=(i,e,m)=>xe(m).format("YYYY-MM-DD HH:mm:ss"),h=()=>{const i=p.value;if(!i||!i.serverSign||!i.serverName){N.error("缺失参数(服务标识|服务名称)");return}x.post("/server",{serverSign:i.serverSign,serverName:i.serverName,serverRemark:i.serverRemark,isEnable:i.isEnable?1:2,isOperateSensitiveData:i.isOperateSensitiveData?1:2,isEnableIPlist:i.isEnableIPlist?1:2}).then(function(e){g.value=!1,y(),N.success(e.data.msg)})},y=()=>{x.get("/server/paging",{params:{pageNo:H.value,pageSize:z.value,searchTxt:D.value}}).then(function(i){let e=i.data.data;M.value=e.rows,Y.value=e.total})};y();const q=i=>i===1?"启用":i===2?"禁用":i,ee=i=>i===1?"允许":i===2?"禁止":i,le=i=>{_=n({id:i.id,serverSign:i.serverSign,serverName:i.serverName,serverRemark:i.serverRemark}),c.value=!0},ae=()=>{let i=_.value;x.put("/server/base",{id:i.id,serverSign:i.serverSign,serverName:i.serverName,serverRemark:i.serverRemark}).then(function(e){c.value=!1,y(),N.success(e.data.msg)})},te=i=>{x.get("/server/"+i.serverSign).then(function(e){f.value=e.data.data,E.value=!0})},ie=i=>{b=n({id:i.id,serverSign:i.serverSign,serverName:i.serverName,isEnable:i.isEnable===1,isOperateSensitiveData:i.isOperateSensitiveData===1,isEnableIPlist:i.isEnableIPlist===1}),S.value=!0},se=()=>{let i=b.value;x.put("/server/enable",{id:i.id,serverSign:i.serverSign,serverName:i.serverName,isEnable:i.isEnable?1:2,isOperateSensitiveData:i.isOperateSensitiveData?1:2,isEnableIPlist:i.isEnableIPlist?1:2}).then(function(e){S.value=!1,y(),N.success(e.data.msg)})},T=i=>{x.get("/server/"+i+"/iplist").then(function(e){j.value=e.data.data})},ne=i=>{x.get("/server/"+i.serverSign).then(function(e){f.value=e.data.data,T(f.value.serverSign),C.value=!0})},re=i=>{x.delete("/server/iplist",{data:i}).then(function(e){N.success(e.data.msg),T(i.serverSign)})},oe=()=>{const i=f.value.serverSign;I.value={serverSign:i,ip:""},w.value=!0},de=()=>{x.post("/server/iplist",I.value).then(function(i){N.success(i.data.msg),w.value=!1,T(I.value.serverSign)})};return(i,e)=>{const m=V("el-input"),d=V("el-button"),v=V("el-table-column"),F=V("el-tag"),A=V("el-table"),ue=V("el-pagination"),me=V("el-card"),o=V("el-form-item"),U=V("el-switch"),O=V("el-form"),P=V("el-dialog"),pe=ge("loading");return G(),be(Se,null,[a(me,{class:"box-card",style:Ve(s($))},{header:t(()=>[k("div",ke,[a(m,{modelValue:s(D),"onUpdate:modelValue":e[0]||(e[0]=l=>u(D)?D.value=l:D=l),placeholder:"搜索服务标识",class:"search",size:"large",style:{width:"260px"},"suffix-icon":s(_e),clearable:"",onKeydown:[J(X,["enter"]),J(Z,["esc"])]},null,8,["modelValue","suffix-icon"]),a(d,{color:"#337ecc",plain:"",style:{"margin-left":"20px"},onClick:e[1]||(e[1]=l=>u(g)?g.value=!0:g=!0)},{default:t(()=>[r(" 新增服务 ")]),_:1})])]),default:t(()=>[ce((G(),we(A,{data:s(M),"element-loading-text":"Loading...",style:{width:"100%"},stripe:""},{default:t(()=>[a(v,{prop:"id",fixed:"",label:"ID","min-width":"60"}),a(v,{prop:"serverSign",label:"服务标识"}),a(v,{prop:"serverName",label:"服务名称"}),a(v,{prop:"serverRemark",label:"服务描述"}),a(v,{prop:"isEnable",label:"服务状态",width:"80"},{default:t(l=>[a(F,{type:l.row.isEnable===1?"success":"danger"},{default:t(()=>[r(B(q(l.row.isEnable)),1)]),_:2},1032,["type"])]),_:1}),a(v,{prop:"isOperateSensitiveData",label:"操作敏感信息"},{default:t(l=>[a(F,{type:l.row.isOperateSensitiveData===1?"success":"danger"},{default:t(()=>[r(B(ee(l.row.isOperateSensitiveData)),1)]),_:2},1032,["type"])]),_:1}),a(v,{prop:"isEnableIPlist",label:"IP白名单",width:"80"},{default:t(l=>[a(F,{type:l.row.isEnableIPlist===1?"success":"danger"},{default:t(()=>[r(B(q(l.row.isEnableIPlist)),1)]),_:2},1032,["type"])]),_:1}),a(v,{prop:"createTime",formatter:L,label:"创建时间",width:"165"}),a(v,{prop:"updateTime",formatter:L,label:"更新时间",width:"165"}),a(v,{label:"操作",width:"330"},{default:t(l=>[a(d,{plain:"",type:"primary",size:"small",onClick:R=>le(l.row)},{default:t(()=>[r(" 编辑 ")]),_:2},1032,["onClick"]),a(d,{plain:"",type:"success",size:"small",onClick:R=>ne(l.row)},{default:t(()=>[r(" IP白名单 ")]),_:2},1032,["onClick"]),a(d,{plain:"",type:"warning",size:"small",onClick:R=>te(l.row)},{default:t(()=>[r(" 查看密钥 ")]),_:2},1032,["onClick"]),a(d,{type:"warning",plain:"",size:"small",onClick:R=>ie(l.row)},{default:t(()=>[r(" 启用/禁用 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[pe,s(Q)]]),a(ue,{style:{"margin-top":"10px",float:"right"},"current-page":s(H),"onUpdate:currentPage":e[2]||(e[2]=l=>u(H)?H.value=l:H=l),"page-size":s(z),"onUpdate:pageSize":e[3]||(e[3]=l=>u(z)?z.value=l:z=l),"page-sizes":[5,10,30,100],layout:"total,prev,pager,next,sizes",total:s(Y),onSizeChange:K,onCurrentChange:K},null,8,["current-page","page-size","total"])]),_:1},8,["style"]),a(P,{modelValue:s(g),"onUpdate:modelValue":e[11]||(e[11]=l=>u(g)?g.value=l:g=l),title:"新增接入服务",width:"50%",center:"",draggable:""},{footer:t(()=>[k("span",Ee,[a(d,{onClick:e[10]||(e[10]=l=>u(g)?g.value=!1:g=!1)},{default:t(()=>[r("取消")]),_:1}),a(d,{type:"warning",plain:"",onClick:h},{default:t(()=>[r(" 确定 ")]),_:1})])]),default:t(()=>[a(O,{model:s(p),"label-width":"200px"},{default:t(()=>[a(o,{label:"服务标识"},{default:t(()=>[a(m,{modelValue:s(p).serverSign,"onUpdate:modelValue":e[4]||(e[4]=l=>s(p).serverSign=l),clearable:""},null,8,["modelValue"])]),_:1}),a(o,{label:"服务名称"},{default:t(()=>[a(m,{modelValue:s(p).serverName,"onUpdate:modelValue":e[5]||(e[5]=l=>s(p).serverName=l),clearable:""},null,8,["modelValue"])]),_:1}),a(o,{label:"服务描述"},{default:t(()=>[a(m,{modelValue:s(p).serverRemark,"onUpdate:modelValue":e[6]||(e[6]=l=>s(p).serverRemark=l),clearable:""},null,8,["modelValue"])]),_:1}),a(o,{label:"是否启用"},{default:t(()=>[a(U,{modelValue:s(p).isEnable,"onUpdate:modelValue":e[7]||(e[7]=l=>s(p).isEnable=l),"inline-prompt":"","active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),a(o,{label:"操作敏感消息"},{default:t(()=>[a(U,{modelValue:s(p).isOperateSensitiveData,"onUpdate:modelValue":e[8]||(e[8]=l=>s(p).isOperateSensitiveData=l),"inline-prompt":"","active-text":"允许","inactive-text":"禁止"},null,8,["modelValue"])]),_:1}),a(o,{label:"IP白名单"},{default:t(()=>[a(U,{modelValue:s(p).isEnableIPlist,"onUpdate:modelValue":e[9]||(e[9]=l=>s(p).isEnableIPlist=l),"inline-prompt":"","active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(P,{modelValue:s(E),"onUpdate:modelValue":e[16]||(e[16]=l=>u(E)?E.value=l:E=l),title:"查看服务密钥",width:"600px",center:"",draggable:""},{footer:t(()=>[k("span",Ce,[a(d,{onClick:e[15]||(e[15]=l=>u(E)?E.value=!1:E=!1)},{default:t(()=>[r("关闭")]),_:1})])]),default:t(()=>[a(O,{model:s(f),"label-width":"100px"},{default:t(()=>[a(o,{label:"服务标识"},{default:t(()=>[a(m,{modelValue:s(f).serverSign,"onUpdate:modelValue":e[12]||(e[12]=l=>s(f).serverSign=l)},null,8,["modelValue"])]),_:1}),a(o,{label:"密钥"},{default:t(()=>[a(m,{modelValue:s(f).serverSecret,"onUpdate:modelValue":e[13]||(e[13]=l=>s(f).serverSecret=l)},null,8,["modelValue"])]),_:1}),a(o,{label:"IV"},{default:t(()=>[a(m,{modelValue:s(f).iv,"onUpdate:modelValue":e[14]||(e[14]=l=>s(f).iv=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(P,{modelValue:s(S),"onUpdate:modelValue":e[22]||(e[22]=l=>u(S)?S.value=l:S=l),title:"启用/禁用",width:"600px",center:"",draggable:""},{footer:t(()=>[k("span",Ie,[a(d,{onClick:e[21]||(e[21]=l=>u(S)?S.value=!1:S=!1)},{default:t(()=>[r("取消")]),_:1}),a(d,{type:"warning",plain:"",onClick:se},{default:t(()=>[r(" 确定修改 ")]),_:1})])]),default:t(()=>[a(O,{model:s(b),"label-width":"100px"},{default:t(()=>[a(o,{label:"服务标识"},{default:t(()=>[a(m,{modelValue:s(b).serverSign,"onUpdate:modelValue":e[17]||(e[17]=l=>s(b).serverSign=l),disabled:"",clearable:""},null,8,["modelValue"])]),_:1}),a(o,{label:"是否启用"},{default:t(()=>[a(U,{modelValue:s(b).isEnable,"onUpdate:modelValue":e[18]||(e[18]=l=>s(b).isEnable=l),"inline-prompt":"","active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),a(o,{label:"操作敏感信息"},{default:t(()=>[a(U,{modelValue:s(b).isOperateSensitiveData,"onUpdate:modelValue":e[19]||(e[19]=l=>s(b).isOperateSensitiveData=l),"inline-prompt":"","active-text":"允许","inactive-text":"禁止"},null,8,["modelValue"])]),_:1}),a(o,{label:"IP白名单"},{default:t(()=>[a(U,{modelValue:s(b).isEnableIPlist,"onUpdate:modelValue":e[20]||(e[20]=l=>s(b).isEnableIPlist=l),"inline-prompt":"","active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(P,{modelValue:s(c),"onUpdate:modelValue":e[27]||(e[27]=l=>u(c)?c.value=l:c=l),title:"修改基础信息",width:"600px",center:"",draggable:""},{footer:t(()=>[k("span",ye,[a(d,{onClick:e[26]||(e[26]=l=>u(c)?c.value=!1:c=!1)},{default:t(()=>[r("取消")]),_:1}),a(d,{type:"warning",plain:"",onClick:ae},{default:t(()=>[r(" 确定修改 ")]),_:1})])]),default:t(()=>[a(O,{model:s(_),"label-width":"100px"},{default:t(()=>[a(o,{label:"服务标识"},{default:t(()=>[a(m,{modelValue:s(_).serverSign,"onUpdate:modelValue":e[23]||(e[23]=l=>s(_).serverSign=l),disabled:""},null,8,["modelValue"])]),_:1}),a(o,{label:"服务名称"},{default:t(()=>[a(m,{modelValue:s(_).serverName,"onUpdate:modelValue":e[24]||(e[24]=l=>s(_).serverName=l)},null,8,["modelValue"])]),_:1}),a(o,{label:"服务描述"},{default:t(()=>[a(m,{modelValue:s(_).serverRemark,"onUpdate:modelValue":e[25]||(e[25]=l=>s(_).serverRemark=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(P,{modelValue:s(C),"onUpdate:modelValue":e[29]||(e[29]=l=>u(C)?C.value=l:C=l),width:"800px",draggable:""},{header:t(({close:l,titleId:R,titleClass:ze})=>[k("div",De,[k("b",null,B("["+s(f).serverSign+"] IP白名单列表"),1),a(d,{plain:"",type:"primary",size:"small",onClick:oe},{default:t(()=>[r(" 增加 ")]),_:1})])]),footer:t(()=>[k("span",Ue,[a(d,{onClick:e[28]||(e[28]=l=>u(C)?C.value=!1:C=!1)},{default:t(()=>[r("关闭")]),_:1})])]),default:t(()=>[a(A,{data:s(j),style:{width:"100%"}},{default:t(()=>[a(v,{prop:"serverSign",label:"服务标识"}),a(v,{prop:"ip",label:"IP"}),a(v,{prop:"createTime",formatter:L,label:"添加时间"}),a(v,{label:"操作",width:"100"},{default:t(l=>[a(d,{plain:"",type:"danger",size:"small",onClick:R=>re(l.row)},{default:t(()=>[r(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue"]),a(P,{modelValue:s(w),"onUpdate:modelValue":e[33]||(e[33]=l=>u(w)?w.value=l:w=l),title:"新增 ["+s(f).serverSign+"] IP白名单列表",width:"600px",center:"",draggable:""},{footer:t(()=>[k("span",Pe,[a(d,{onClick:e[32]||(e[32]=l=>u(w)?w.value=!1:w=!1)},{default:t(()=>[r("取消")]),_:1}),a(d,{type:"warning",plain:"",onClick:de},{default:t(()=>[r(" 确定增加 ")]),_:1})])]),default:t(()=>[a(O,{model:s(I),"label-width":"100px"},{default:t(()=>[a(o,{label:"服务标识"},{default:t(()=>[a(m,{modelValue:s(I).serverSign,"onUpdate:modelValue":e[30]||(e[30]=l=>s(I).serverSign=l),disabled:"",clearable:""},null,8,["modelValue"])]),_:1}),a(o,{label:"IP"},{default:t(()=>[a(m,{modelValue:s(I).ip,"onUpdate:modelValue":e[31]||(e[31]=l=>s(I).ip=l),clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])],64)}}},Re=ve(Ne,[["__scopeId","data-v-cacf20fa"]]);export{Re as default};
